---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => 
  b.data.pubDate.getTime() - a.data.pubDate.getTime()
);
---

<BaseLayout title="Nine Transitions - Trading Blog">
  <section>
    {sortedPosts.map((post) => (
      <article class="post">
        <h3 class="post-title">
          <a href={`/posts/${post.slug}/`}>{post.data.title}</a>
        </h3>
        <div class="post-meta">
          <time>
            {post.data.pubDate.toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
        </div>
        {post.data.description && (
          <div class="post-body">
            <p>{post.data.description}</p>
          </div>
        )}
      </article>
    ))}
  </section>
</BaseLayout>
